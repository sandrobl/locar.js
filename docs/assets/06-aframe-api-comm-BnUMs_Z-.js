import"./modulepreload-polyfill-B5Qt9EMX.js";import"./locar-aframe.es-CqAiDsGS.js";/* empty css              */import"./locar.es-CLGu3crh.js";var c={},l;function m(){if(l)return c;l=1;var n=AFRAME.utils.debug,r=AFRAME.utils.coordinates,i=n("components:look-at:warn"),s=r.isCoordinates||r.isCoordinate;return delete AFRAME.components["look-at"],AFRAME.registerComponent("look-at",{schema:{default:"0 0 0",parse:function(e){return s(e)||typeof e=="object"?r.parse(e):e},stringify:function(e){return typeof e=="object"?r.stringify(e):e}},init:function(){this.target3D=null,this.vector=new THREE.Vector3,this.cameraListener=AFRAME.utils.bind(this.cameraListener,this),this.el.addEventListener("componentinitialized",this.cameraListener),this.el.addEventListener("componentremoved",this.cameraListener)},update:function(){var e=this,t=e.data,o;if(!t||typeof t=="object"&&!Object.keys(t).length)return e.remove();if(typeof t=="object")return this.lookAt(new THREE.Vector3(t.x,t.y,t.z));if(o=e.el.sceneEl.querySelector(t),!o){i('"'+t+'" does not point to a valid entity to look-at');return}return o.hasLoaded?e.beginTracking(o):o.addEventListener("loaded",function(){e.beginTracking(o)})},tick:(function(){var e=new THREE.Vector3;return function(t){var o=this.target3D;o&&(o.getWorldPosition(e),this.lookAt(e))}})(),remove:function(){this.el.removeEventListener("componentinitialized",this.cameraListener),this.el.removeEventListener("componentremoved",this.cameraListener)},beginTracking:function(e){this.target3D=e.object3D},cameraListener:function(e){e.detail&&e.detail.name==="camera"&&this.update()},lookAt:function(e){var t=this.vector,o=this.el.object3D;this.el.getObject3D("camera")?t.subVectors(o.position,e).add(o.position):t.copy(e),o.lookAt(t)}}),c}m();let d=!0;const u=document.querySelector("[locar-camera]"),p=document.querySelector("a-scene");u.addEventListener("gpsupdate",async n=>{const r=n.detail.position;r.coords.latitude!=0&&r.coords.longitude!=0&&d&&(alert(`Got the initial location: longitude ${r.coords.longitude}, latitude ${r.coords.latitude}`),(await(await fetch(`https://hikar.org/webapp/map?bbox=${r.coords.longitude-.02},${r.coords.latitude-.02},${r.coords.longitude+.02},${r.coords.latitude+.02}&layers=poi&outProj=4326`)).json()).features.forEach(e=>{const t=document.createElement("a-image");t.setAttribute("src","#map-marker"),t.setAttribute("scale","20 20 20");const o=document.createElement("a-entity");o.setAttribute("text",{value:e.properties.name||"No name",align:"center"}),o.setAttribute("scale","100 100 100"),o.setAttribute("look-at","[camera]");const a=document.createElement("a-entity");a.setAttribute("locar-entity-place",{latitude:parseFloat(e.geometry.coordinates[1]),longitude:parseFloat(e.geometry.coordinates[0])}),t.setAttribute("position",{y:20}),a.appendChild(t),a.appendChild(o),p.appendChild(a)}),d=!1)});document.querySelector("#setFakeLoc").addEventListener("click",n=>{const r=document.getElementById("fakeLat").value,i=document.getElementById("fakeLon").value;u.setAttribute("locar-camera",{simulateLatitude:parseFloat(r),simulateLongitude:parseFloat(i)})});
