import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css              */import{P as y,W as x,S as b,B as S,a as G,M}from"./three.module-Cg0hSL1k.js";import{L as C,H as N,x as F}from"./locar.es-CLGu3crh.js";const v={latitude:47.41047675920058,longitude:9.332869851461123},l=5,R=16724838,s=new y(80,window.innerWidth/window.innerHeight,.001,1e3),u=new x({canvas:document.getElementById("glscene")});u.setSize(window.innerWidth,window.innerHeight);const d=new b,i=new C(d,s),w=new N({video:{facingMode:"environment"}},null);w.on("webcamstarted",e=>{d.background=e.texture});w.on("webcamerror",e=>{alert(`Webcam error: code ${e.code} message ${e.message}`)});window.addEventListener("resize",()=>{u.setSize(window.innerWidth,window.innerHeight),s.aspect=window.innerWidth/window.innerHeight,s.updateProjectionMatrix()});let f=!0,a=!1,n=null;const t={latitude:v.latitude,longitude:v.longitude};let c=null;const m=new F(s);m.on("deviceorientationgranted",e=>{e.target.connect()});m.on("deviceorientationerror",e=>{alert(`Device orientation error: code ${e.code} message ${e.message}`)});m.init();i.on("gpserror",e=>{alert(`GPS error: ${e.code}`)});i.on("gpsupdate",e=>{f&&(alert(`Got the initial location: longitude ${e.position.coords.longitude}, latitude ${e.position.coords.latitude}`),f=!1),j(e.position.coords.latitude,e.position.coords.longitude),a?I():(n=B(),i.add(n,t.longitude,t.latitude),a=!0,g())});i.startGps();const L=document.getElementById("fakeLat"),P=document.getElementById("fakeLon"),W=document.getElementById("setFakeLoc"),$=document.getElementById("resumeRealGps"),D=document.getElementById("moveNorth"),T=document.getElementById("moveSouth"),O=document.getElementById("moveWest"),A=document.getElementById("moveEast"),_=document.getElementById("removePoi"),z=document.getElementById("spawnPoiAtDevice"),h=document.getElementById("deviceCoords"),E=document.getElementById("poiCoords");W.addEventListener("click",()=>{const e=parseFloat(L.value),o=parseFloat(P.value);if(Number.isNaN(e)||Number.isNaN(o)){alert("Please enter valid numeric latitude / longitude values.");return}alert("Using fake input GPS, not real GPS location"),i.stopGps(),i.fakeGps(o,e)});$.addEventListener("click",()=>{alert("Resuming real GPS updates"),h.textContent="waiting for GPS…",i.startGps()});D.addEventListener("click",()=>p(l,0));T.addEventListener("click",()=>p(-l,0));O.addEventListener("click",()=>p(0,-l));A.addEventListener("click",()=>p(0,l));_.addEventListener("click",U);z.addEventListener("click",V);u.setAnimationLoop(H);function H(){m?.update(),u.render(d,s)}function B(){const e=new S(12,12,12),o=new G({color:R,opacity:.85,transparent:!0}),r=new M(e,o);return r.name="Example POI",r}function I(){if(!a||!n)return;const[e,o]=i.lonLatToWorldCoords(t.longitude,t.latitude);n.position.x=e,n.position.z=o}function g(){L.value=t.latitude.toFixed(8),P.value=t.longitude.toFixed(8),a?E.textContent=`${t.latitude.toFixed(6)}°, ${t.longitude.toFixed(6)}°`:E.textContent="none"}function p(e,o){if(!a||!n){alert("The AR scene is still initialising. Try again when the red marker is visible.");return}const r=111132,k=Math.max(Math.cos(t.latitude*Math.PI/180)*r,1e-6);t.latitude+=e/r,t.longitude+=o/k,I(),g()}function j(e,o){Number.isFinite(e)&&Number.isFinite(o)&&(h.textContent=`${e.toFixed(6)}°, ${o.toFixed(6)}°`,c={latitude:e,longitude:o})}function U(){if(!a||!n){alert("No cube to remove right now.");return}d.remove(n),n=null,a=!1,g()}function V(){if(!c){alert("Device location not available yet. Wait for GPS before spawning the cube.");return}a&&n&&d.remove(n),t.latitude=c.latitude,t.longitude=c.longitude,n=B(),i.add(n,t.longitude,t.latitude),a=!0,g()}
