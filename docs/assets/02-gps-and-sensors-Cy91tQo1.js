import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css              */import{P as b,W as M,S as G,B as F,a as N,M as T,L as A,E as O,b as R}from"./three.module-jZqFDccH.js";import{L as W,H as _,x as $}from"./locar.es-CLGu3crh.js";const E={latitude:47.41047675920058,longitude:9.332869851461123},u=5,D=[16724838,16762173,5231045,3711337,6717162,16156595],H=.6,d=new b(80,window.innerWidth/window.innerHeight,.001,1e3),m=new M({canvas:document.getElementById("glscene")});m.setSize(window.innerWidth,window.innerHeight);const c=new G,i=new W(c,d),I=new _({video:{facingMode:"environment"}},null);I.on("webcamstarted",e=>{c.background=e.texture});I.on("webcamerror",e=>{alert(`Webcam error: code ${e.code} message ${e.message}`)});window.addEventListener("resize",()=>{m.setSize(window.innerWidth,window.innerHeight),d.aspect=window.innerWidth/window.innerHeight,d.updateProjectionMatrix()});let w=!0,a=!1,n=null;const t={latitude:E.latitude,longitude:E.longitude};let l=null;const g=new $(d);g.on("deviceorientationgranted",e=>{e.target.connect()});g.on("deviceorientationerror",e=>{alert(`Device orientation error: code ${e.code} message ${e.message}`)});g.init();i.on("gpserror",e=>{alert(`GPS error: ${e.code}`)});i.on("gpsupdate",e=>{w&&(alert(`Got the initial location: longitude ${e.position.coords.longitude}, latitude ${e.position.coords.latitude}`),w=!1),X(e.position.coords.latitude,e.position.coords.longitude),a?k():(n=y(),i.add(n,t.longitude,t.latitude),a=!0,p())});i.startGps();const B=document.getElementById("fakeLat"),x=document.getElementById("fakeLon"),z=document.getElementById("setFakeLoc"),j=document.getElementById("resumeRealGps"),U=document.getElementById("moveNorth"),V=document.getElementById("moveSouth"),Y=document.getElementById("moveWest"),q=document.getElementById("moveEast"),J=document.getElementById("removePoi"),K=document.getElementById("spawnPoiAtDevice"),h=document.getElementById("deviceCoords"),L=document.getElementById("poiCoords"),P=document.getElementById("gpsinput"),r=document.getElementById("gpsinputToggle");z.addEventListener("click",()=>{const e=parseFloat(B.value),o=parseFloat(x.value);if(Number.isNaN(e)||Number.isNaN(o)){alert("Please enter valid numeric latitude / longitude values.");return}alert("Using fake input GPS, not real GPS location"),i.stopGps(),i.fakeGps(o,e)});j.addEventListener("click",()=>{alert("Resuming real GPS updates"),h.textContent="waiting for GPS…",i.startGps()});U.addEventListener("click",()=>f(u,0));V.addEventListener("click",()=>f(-u,0));Y.addEventListener("click",()=>f(0,-u));q.addEventListener("click",()=>f(0,u));J.addEventListener("click",Z);K.addEventListener("click",ee);r&&P&&r.addEventListener("click",()=>{const e=P.classList.toggle("gpsinput-collapsed");r.setAttribute("aria-expanded",(!e).toString()),r.textContent=e?"► Controls":"▼ Controls",r.title=e?"Show testing controls":"Hide testing controls"});m.setAnimationLoop(Q);function Q(){g?.update(),m.render(c,d)}function y(){const e=new F(12,12,12),o=D.map(S=>new N({color:S,opacity:H,transparent:!0})),s=new T(e,o),v=new A({color:16777215,opacity:.3,transparent:!0}),C=new O(e);return s.add(new R(C,v)),s.name="Example POI",s}function k(){if(!a||!n)return;const[e,o]=i.lonLatToWorldCoords(t.longitude,t.latitude);n.position.x=e,n.position.z=o}function p(){B.value=t.latitude.toFixed(8),x.value=t.longitude.toFixed(8),a?L.textContent=`${t.latitude.toFixed(6)}°, ${t.longitude.toFixed(6)}°`:L.textContent="none"}function f(e,o){if(!a||!n){alert("The AR scene is still initialising. Try again when the red marker is visible.");return}const s=111132,v=Math.max(Math.cos(t.latitude*Math.PI/180)*s,1e-6);t.latitude+=e/s,t.longitude+=o/v,k(),p()}function X(e,o){Number.isFinite(e)&&Number.isFinite(o)&&(h.textContent=`${e.toFixed(6)}°, ${o.toFixed(6)}°`,l={latitude:e,longitude:o})}function Z(){if(!a||!n){alert("No cube to remove right now.");return}c.remove(n),n=null,a=!1,p()}function ee(){if(!l){alert("Device location not available yet. Wait for GPS before spawning the cube.");return}a&&n&&c.remove(n),t.latitude=l.latitude,t.longitude=l.longitude,n=y(),i.add(n,t.longitude,t.latitude),a=!0,p()}
