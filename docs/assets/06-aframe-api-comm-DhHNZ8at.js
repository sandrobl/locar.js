import"./modulepreload-polyfill-B5Qt9EMX.js";import"./locar-aframe.es-DGwGR2zQ.js";/* empty css              */import"./locar.es-C46cmtya.js";var d=AFRAME.utils.debug,a=AFRAME.utils.coordinates,u=d("components:look-at:warn"),m=a.isCoordinates||a.isCoordinate;delete AFRAME.components["look-at"];AFRAME.registerComponent("look-at",{schema:{default:"0 0 0",parse:function(t){return m(t)||typeof t=="object"?a.parse(t):t},stringify:function(t){return typeof t=="object"?a.stringify(t):t}},init:function(){this.target3D=null,this.vector=new THREE.Vector3,this.cameraListener=AFRAME.utils.bind(this.cameraListener,this),this.el.addEventListener("componentinitialized",this.cameraListener),this.el.addEventListener("componentremoved",this.cameraListener)},update:function(){var t=this,e=t.data,o;if(!e||typeof e=="object"&&!Object.keys(e).length)return t.remove();if(typeof e=="object")return this.lookAt(new THREE.Vector3(e.x,e.y,e.z));if(o=t.el.sceneEl.querySelector(e),!o){u('"'+e+'" does not point to a valid entity to look-at');return}return o.hasLoaded?t.beginTracking(o):o.addEventListener("loaded",function(){t.beginTracking(o)})},tick:function(){var t=new THREE.Vector3;return function(e){var o=this.target3D;o&&(o.getWorldPosition(t),this.lookAt(t))}}(),remove:function(){this.el.removeEventListener("componentinitialized",this.cameraListener),this.el.removeEventListener("componentremoved",this.cameraListener)},beginTracking:function(t){this.target3D=t.object3D},cameraListener:function(t){t.detail&&t.detail.name==="camera"&&this.update()},lookAt:function(t){var e=this.vector,o=this.el.object3D;this.el.getObject3D("camera")?e.subVectors(o.position,t).add(o.position):e.copy(t),o.lookAt(e)}});let c=!0;const l=document.querySelector("[locar-camera]"),p=document.querySelector("a-scene");l.addEventListener("gpsupdate",async t=>{const e=t.detail.position;e.coords.latitude!=0&&e.coords.longitude!=0&&c&&(alert(`Got the initial location: longitude ${e.coords.longitude}, latitude ${e.coords.latitude}`),(await(await fetch(`https://hikar.org/webapp/map?bbox=${e.coords.longitude-.02},${e.coords.latitude-.02},${e.coords.longitude+.02},${e.coords.latitude+.02}&layers=poi&outProj=4326`)).json()).features.forEach(s=>{const i=document.createElement("a-image");i.setAttribute("src","#map-marker"),i.setAttribute("scale","20 20 20");const r=document.createElement("a-entity");r.setAttribute("text",{value:s.properties.name||"No name",align:"center"}),r.setAttribute("scale","100 100 100"),r.setAttribute("look-at","[camera]");const n=document.createElement("a-entity");n.setAttribute("locar-entity-place",{latitude:parseFloat(s.geometry.coordinates[1]),longitude:parseFloat(s.geometry.coordinates[0])}),i.setAttribute("position",{y:20}),n.appendChild(i),n.appendChild(r),p.appendChild(n)}),c=!1)});document.querySelector("#setFakeLoc").addEventListener("click",t=>{const e=document.getElementById("fakeLat").value,o=document.getElementById("fakeLon").value;l.setAttribute("locar-camera",{simulateLatitude:parseFloat(e),simulateLongitude:parseFloat(o)})});
