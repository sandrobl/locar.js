import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css              */import{P as m,W as l,S as w,B as g,M as u,a as f}from"./three.module-jZqFDccH.js";import{L as h,x as b,H as y,N as $}from"./locar.es-CLGu3crh.js";const t=new m(80,window.innerWidth/window.innerHeight,.001,1e3),i=new l({canvas:document.getElementById("glscene")});i.setSize(window.innerWidth,window.innerHeight);const r=new w,o=new h(r,t),s=new b(t);s.on("deviceorientationgranted",e=>{e.target.connect()});s.on("deviceorientationerror",e=>{alert(`Device orientation error: code ${e.code} message ${e.message}`)});s.init();const p=new y({video:{facingMode:"environment"}},null);p.on("webcamstarted",e=>{r.background=e.texture});p.on("webcamerror",e=>{alert(`Webcam error: code ${e.code} message ${e.message}`)});window.addEventListener("resize",e=>{i.setSize(window.innerWidth,window.innerHeight),t.aspect=window.innerWidth/window.innerHeight,t.updateProjectionMatrix()});let c=!0;const d={},k=new g(20,20,20),v=new $(i);o.on("gpserror",e=>{alert(`GPS error: code ${e.code}`)});o.on("gpsupdate",async e=>{(c||e.distMoved>100)&&((await(await fetch(`https://hikar.org/webapp/map?bbox=${e.position.coords.longitude-.02},${e.position.coords.latitude-.02},${e.position.coords.longitude+.02},${e.position.coords.latitude+.02}&layers=poi&outProj=4326`)).json()).features.forEach(n=>{if(!d[n.properties.osm_id]){const a=new u(k,new f({color:16711680}));o.add(a,n.geometry.coordinates[0],n.geometry.coordinates[1],0,n.properties),d[n.properties.osm_id]=a}}),c=!1)});document.getElementById("setFakeLoc").addEventListener("click",e=>{alert("Using fake input GPS, not real GPS location"),o.stopGps(),o.fakeGps(parseFloat(document.getElementById("fakeLon").value),parseFloat(document.getElementById("fakeLat").value))});o.startGps();i.setAnimationLoop(G);function G(){s.update();const e=v.raycast(t,r);e.length&&alert(`This is ${e[0].object.properties.name}`),i.render(r,t)}
